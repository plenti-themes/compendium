import{SvelteComponent,claim_component,component_subscribe,create_component,destroy_component,init,mount_component,safe_not_equal,transition_in,transition_out}from"../web_modules/svelte/internal/index.mjs";import Html from"../layouts/global/html.js";import Navaid from"../web_modules/navaid/dist/navaid.mjs";import allContent from"../generated/content.js";import*as allLayouts from"../generated/layouts.js";import{env}from"../generated/env.js";import{user}from"./cms/auth.js";import allDefaults from"../generated/defaults.js";function create_fragment(e){let t,n;return t=new Html({props:{path:e[0],params:e[1],content:e[2],layout:e[3],allContent,allLayouts,env,user,shadowContent:e[4]}}),{c(){create_component(t.$$.fragment)},l(e){claim_component(t.$$.fragment,e)},m(e,s){mount_component(t,e,s),n=!0},p(e,[n]){const s={};n&1&&(s.path=e[0]),n&2&&(s.params=e[1]),n&4&&(s.content=e[2]),n&8&&(s.layout=e[3]),t.$set(s)},i(e){if(n)return;transition_in(t.$$.fragment,e),n=!0},o(e){transition_out(t.$$.fragment,e),n=!1},d(e){destroy_component(t,e)}}}function instance(e,t,n){let o;component_subscribe(e,user,e=>n(5,o=e));let l=location.pathname,r=new URLSearchParams(location.search),s=allContent.find(e=>e.filepath===document.documentElement.dataset.contentFilepath),a,u={};o.isBeingAuthenticated&&o.finishAuthentication(r);function c(e){n(0,l=e.state||e.uri||location.pathname),n(1,r=new URLSearchParams(location.search))}addEventListener("replacestate",c),addEventListener("pushstate",c),addEventListener("popstate",c);const i=()=>{n(2,s=allContent.find(e=>e.filepath==="content/404.json")),s===void 0&&n(2,s={path:"/404",type:"404",filename:"404.json",fields:{}}),import("../layouts/content/404.js").then(e=>{n(3,a=e.default)}).catch(e=>{console.log("Add a '/layouts/content/404.svelte' file to handle Page Not Found errors."),console.log("If you want to pass data to your 404 component, you can also add a '/content/404.json' file."),console.log(e)})},h=()=>{let e=env.baseurl?env.baseurl:"/";if(location.pathname!==e)return!1;if(location.hash.startsWith("#add/")&&o.isAuthenticated){const[e,t]=location.hash.substring("#add/".length).split("/"),o=allDefaults.find(t=>t.type==e);return e&&t&&o?(import("../layouts/content/"+e+".js").then(e=>{n(2,s=structuredClone(o)),n(2,s.isNew=!0,s),n(2,s.filename=t+".json",s),n(2,s.filepath=s.filepath.replace("_defaults.json",t+".json"),s),n(3,a=e.default)}).catch(i),!0):(i(),!0)}return!1},d=Navaid("/",i);return allContent.forEach(e=>{d.on(env.baseurl+e.path,()=>{if(h())return;import("../layouts/content/"+e.type+".js").then(t=>{s.filepath!==e.filepath&&window.scrollTo(0,0),n(2,s=e),n(3,a=t.default)}).catch(i)})}),d.listen(),[l,r,s,a,u]}class Component extends SvelteComponent{constructor(e){super(),init(this,e,instance,create_fragment,safe_not_equal,{})}}export default Component